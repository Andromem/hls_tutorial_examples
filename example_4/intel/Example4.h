#define N 1024
#define D 8 // this must be defined as macro not as __constant